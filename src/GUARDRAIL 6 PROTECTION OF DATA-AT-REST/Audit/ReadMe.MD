See Module 5. Module 6 is implemented through the same script.